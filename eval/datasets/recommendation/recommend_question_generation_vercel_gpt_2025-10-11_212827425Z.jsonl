{"input":{"issue":"Tool execution scenario"},"output":"{\n  \"required\": [\n    {\n      \"id\": \"name\",\n      \"question\": \"What is the name for this deployment?\",\n      \"type\": \"text\",\n      \"placeholder\": \"e.g., pg-staging\",\n      \"validation\": {\n        \"required\": true,\n        \"min\": 1,\n        \"max\": 63,\n        \"pattern\": \"^[a-z0-9]([-a-z0-9]*[a-z0-9])?$\"\n      },\n      \"suggestedAnswer\": \"pg-staging\"\n    },\n    {\n      \"id\": \"namespace\",\n      \"question\": \"Which namespace should this PostgreSQL cluster be deployed into?\",\n      \"type\": \"select\",\n      \"options\": [\"cnpg-system\", \"default\", \"kube-node-lease\", \"kube-public\", \"kube-system\", \"kyverno\", \"local-path-storage\"],\n      \"placeholder\": \"Select a namespace\",\n      \"validation\": {\n        \"required\": true\n      },\n      \"suggestedAnswer\": \"default\"\n    },\n    {\n      \"id\": \"instances\",\n      \"question\": \"How many PostgreSQL instances do you want? (1 for single-replica, 2 for simple primary+replica)\",\n      \"type\": \"number\",\n      \"placeholder\": \"e.g., 1 or 2\",\n      \"validation\": {\n        \"required\": true,\n        \"min\": 1,\n        \"max\": 5\n      },\n      \"suggestedAnswer\": 1\n    },\n    {\n      \"id\": \"storage_size\",\n      \"question\": \"What storage size should each PostgreSQL instance use?\",\n      \"type\": \"text\",\n      \"placeholder\": \"e.g., 10Gi\",\n      \"validation\": {\n        \"required\": true,\n        \"pattern\": \"^[1-9][0-9]*Gi$\"\n      },\n      \"suggestedAnswer\": \"10Gi\"\n    },\n    {\n      \"id\": \"storage_class\",\n      \"question\": \"Which StorageClass should be used for PostgreSQL data volumes?\",\n      \"type\": \"select\",\n      \"options\": [\"standard\"],\n      \"placeholder\": \"Select a StorageClass\",\n      \"validation\": {\n        \"required\": true\n      },\n      \"suggestedAnswer\": \"standard\"\n    },\n    {\n      \"id\": \"db_name\",\n      \"question\": \"What is the name of the application database to create at bootstrap?\",\n      \"type\": \"text\",\n      \"placeholder\": \"e.g., appdb\",\n      \"validation\": {\n        \"required\": true,\n        \"pattern\": \"^[A-Za-z_][A-Za-z0-9_]*$\"\n      },\n      \"suggestedAnswer\": \"appdb\"\n    },\n    {\n      \"id\": \"db_user\",\n      \"question\": \"What application role (username) should be created?\",\n      \"type\": \"text\",\n      \"placeholder\": \"e.g., appuser\",\n      \"validation\": {\n        \"required\": true,\n        \"pattern\": \"^[a-z_][a-z0-9_]{0,31}$\"\n      },\n      \"suggestedAnswer\": \"appuser\"\n    },\n    {\n      \"id\": \"db_password\",\n      \"question\": \"What password should be set for the application role?\",\n      \"type\": \"text\",\n      \"placeholder\": \"Use a strong password, 12+ characters\",\n      \"validation\": {\n        \"required\": true,\n        \"min\": 12,\n        \"max\": 128\n      },\n      \"suggestedAnswer\": \"A1b2C3d4E5f6!\"\n    }\n  ],\n  \"basic\": [\n    {\n      \"id\": \"port\",\n      \"question\": \"Which TCP port should PostgreSQL listen on for clients?\",\n      \"type\": \"number\",\n      \"placeholder\": \"e.g., 5432\",\n      \"validation\": {\n        \"required\": true,\n        \"min\": 1,\n        \"max\": 65535\n      },\n      \"suggestedAnswer\": 5432\n    },\n    {\n      \"id\": \"enable_pooler_rw\",\n      \"question\": \"Enable PgBouncer connection pooler for read-write traffic?\",\n      \"type\": \"boolean\",\n      \"placeholder\": \"Enables a Pooler resource for RW connections\",\n      \"validation\": {\n        \"required\": true\n      },\n      \"suggestedAnswer\": true\n    },\n    {\n      \"id\": \"enable_pooler_ro\",\n      \"question\": \"Enable PgBouncer connection pooler for read-only traffic (replicas)?\",\n      \"type\": \"boolean\",\n      \"placeholder\": \"Enables a Pooler resource for RO connections\",\n      \"validation\": {\n        \"required\": true\n      },\n      \"suggestedAnswer\": true\n    },\n    {\n      \"id\": \"pooler_instances\",\n      \"question\": \"How many PgBouncer instances (pods) should run?\",\n      \"type\": \"number\",\n      \"placeholder\": \"e.g., 1\",\n      \"validation\": {\n        \"required\": true,\n        \"min\": 1,\n        \"max\": 5\n      },\n      \"suggestedAnswer\": 1\n    },\n    {\n      \"id\": \"pool_mode\",\n      \"question\": \"What PgBouncer pool mode should be used?\",\n      \"type\": \"select\",\n      \"options\": [\"transaction\", \"session\"],\n      \"placeholder\": \"Choose pool mode\",\n      \"validation\": {\n        \"required\": true\n      },\n      \"suggestedAnswer\": \"transaction\"\n    },\n    {\n      \"id\": \"pgbouncer_service_type\",\n      \"question\": \"What Service type should expose the PgBouncer endpoints?\",\n      \"type\": \"select\",\n      \"options\": [\"ClusterIP\", \"NodePort\", \"LoadBalancer\"],\n      \"placeholder\": \"Select Service type for client access\",\n      \"validation\": {\n        \"required\": true\n      },\n      \"suggestedAnswer\": \"ClusterIP\"\n    },\n    {\n      \"id\": \"restrict_network\",\n      \"question\": \"Apply a NetworkPolicy to restrict who can connect to PostgreSQL?\",\n      \"type\": \"boolean\",\n      \"placeholder\": \"If enabled, only selected namespaces/CIDRs can reach DB ports\",\n      \"validation\": {\n        \"required\": true\n      },\n      \"suggestedAnswer\": true\n    },\n    {\n      \"id\": \"allowed_from_namespaces\",\n      \"question\": \"If restricting network, which namespaces may connect?\",\n      \"type\": \"multiselect\",\n      \"options\": [\"cnpg-system\", \"default\", \"kube-node-lease\", \"kube-public\", \"kube-system\", \"kyverno\", \"local-path-storage\"],\n      \"placeholder\": \"Select one or more namespaces\",\n      \"validation\": {\n        \"required\": false\n      },\n      \"suggestedAnswer\": \"default\"\n    }\n  ],\n  \"advanced\": [\n    {\n      \"id\": \"enable_superuser_access\",\n      \"question\": \"Allow superuser access to the cluster (spec.enableSuperuserAccess)?\",\n      \"type\": \"boolean\",\n      \"placeholder\": \"If true, a superuser Secret can be provided/created\",\n      \"validation\": {\n        \"required\": true\n      },\n      \"suggestedAnswer\": false\n    },\n    {\n      \"id\": \"superuser_password\",\n      \"question\": \"If superuser access is enabled, specify a postgres superuser password (optional).\",\n      \"type\": \"text\",\n      \"placeholder\": \"Leave blank to skip; 12+ characters if provided\",\n      \"validation\": {\n        \"required\": false,\n        \"min\": 12,\n        \"max\": 128\n      },\n      \"suggestedAnswer\": \"S0m3Sup3rS3cur3Pwd!\"\n    },\n    {\n      \"id\": \"cpu_request\",\n      \"question\": \"CPU request for PostgreSQL pods (spec.resources.requests.cpu)\",\n      \"type\": \"text\",\n      \"placeholder\": \"e.g., 500m or 1\",\n      \"validation\": {\n        \"required\": false,\n        \"pattern\": \"^([1-9][0-9]*m|[1-9][0-9]*)$\"\n      },\n      \"suggestedAnswer\": \"500m\"\n    },\n    {\n      \"id\": \"memory_request\",\n      \"question\": \"Memory request for PostgreSQL pods (spec.resources.requests.memory)\",\n      \"type\": \"text\",\n      \"placeholder\": \"e.g., 1Gi or 512Mi\",\n      \"validation\": {\n        \"required\": false,\n        \"pattern\": \"^[1-9][0-9]*(Mi|Gi)$\"\n      },\n      \"suggestedAnswer\": \"1Gi\"\n    },\n    {\n      \"id\": \"cpu_limit\",\n      \"question\": \"CPU limit for PostgreSQL pods (spec.resources.limits.cpu)\",\n      \"type\": \"text\",\n      \"placeholder\": \"e.g., 2 or 1500m\",\n      \"validation\": {\n        \"required\": false,\n        \"pattern\": \"^([1-9][0-9]*m|[1-9][0-9]*)$\"\n      },\n      \"suggestedAnswer\": \"2\"\n    },\n    {\n      \"id\": \"memory_limit\",\n      \"question\": \"Memory limit for PostgreSQL pods (spec.resources.limits.memory)\",\n      \"type\": \"text\",\n      \"placeholder\": \"e.g., 2Gi\",\n      \"validation\": {\n        \"required\": false,\n        \"pattern\": \"^[1-9][0-9]*(Mi|Gi)$\"\n      },\n      \"suggestedAnswer\": \"2Gi\"\n    },\n    {\n      \"id\": \"wal_size\",\n      \"question\": \"Separate WAL volume size (spec.walStorage.size) if you want WAL on its own PVC\",\n      \"type\": \"text\",\n      \"placeholder\": \"e.g., 5Gi (leave blank to skip)\",\n      \"validation\": {\n        \"required\": false,\n        \"pattern\": \"^[1-9][0-9]*Gi$\"\n      },\n      \"suggestedAnswer\": \"5Gi\"\n    },\n    {\n      \"id\": \"wal_storage_class\",\n      \"question\": \"StorageClass for WAL volume (spec.walStorage.storageClass, optional)\",\n      \"type\": \"select\",\n      \"options\": [\"standard\"],\n      \"placeholder\": \"Select if using separate WAL storage\",\n      \"validation\": {\n        \"required\": false\n      },\n      \"suggestedAnswer\": \"standard\"\n    },\n    {\n      \"id\": \"monitoring_enable_podmonitor\",\n      \"question\": \"Expose PodMonitor for Prometheus scraping (spec.monitoring.enablePodMonitor)?\",\n      \"type\": \"boolean\",\n      \"placeholder\": \"Requires Prometheus Operator to be installed\",\n      \"validation\": {\n        \"required\": true\n      },\n      \"suggestedAnswer\": false\n    },\n    {\n      \"id\": \"primary_update_strategy\",\n      \"question\": \"Primary update strategy during upgrades (spec.primaryUpdateStrategy)\",\n      \"type\": \"select\",\n      \"options\": [\"unsupervised\", \"supervised\"],\n      \"placeholder\": \"Choose how primary is updated\",\n      \"validation\": {\n        \"required\": true\n      },\n      \"suggestedAnswer\": \"unsupervised\"\n    },\n    {\n      \"id\": \"min_sync_replicas\",\n      \"question\": \"Minimum synchronous replicas (spec.minSyncReplicas)\",\n      \"type\": \"number\",\n      \"placeholder\": \"e.g., 0\",\n      \"validation\": {\n        \"required\": true,\n        \"min\": 0,\n        \"max\": 3\n      },\n      \"suggestedAnswer\": 0\n    },\n    {\n      \"id\": \"max_sync_replicas\",\n      \"question\": \"Maximum synchronous replicas (spec.maxSyncReplicas)\",\n      \"type\": \"number\",\n      \"placeholder\": \"e.g., 1\",\n      \"validation\": {\n        \"required\": true,\n        \"min\": 0,\n        \"max\": 3\n      },\n      \"suggestedAnswer\": 1\n    },\n    {\n      \"id\": \"enable_pod_antiaffinity\",\n      \"question\": \"Enable pod anti-affinity to spread instances (spec.affinity.enablePodAntiAffinity)?\",\n      \"type\": \"boolean\",\n      \"placeholder\": \"Helps avoid placing multiple instances on the same node\",\n      \"validation\": {\n        \"required\": true\n      },\n      \"suggestedAnswer\": true\n    },\n    {\n      \"id\": \"node_selector\",\n      \"question\": \"Node selector for PostgreSQL pods (spec.affinity.nodeSelector, single key=value)\",\n      \"type\": \"text\",\n      \"placeholder\": \"e.g., node-role.kubernetes.io/control-plane=true (leave blank to skip)\",\n      \"validation\": {\n        \"required\": false,\n        \"pattern\": \"^[A-Za-z0-9./-]+=[A-Za-z0-9./-]+$\"\n      },\n      \"suggestedAnswer\": \"ingress-ready=true\"\n    },\n    {\n      \"id\": \"pg_hba_lines\",\n      \"question\": \"Optional custom pg_hba.conf lines (spec.postgresql.pg_hba). Provide a single line or leave blank.\",\n      \"type\": \"text\",\n      \"placeholder\": \"e.g., host all all 10.0.0.0/8 md5\",\n      \"validation\": {\n        \"required\": false\n      },\n      \"suggestedAnswer\": \"host all all 10.0.0.0/8 md5\"\n    },\n    {\n      \"id\": \"pgbouncer_max_client_conn\",\n      \"question\": \"PgBouncer max_client_conn parameter (applies if pooler enabled)\",\n      \"type\": \"number\",\n      \"placeholder\": \"e.g., 500\",\n      \"validation\": {\n        \"required\": false,\n        \"min\": 50,\n        \"max\": 5000\n      },\n      \"suggestedAnswer\": 500\n    },\n    {\n      \"id\": \"allowed_cidrs\",\n      \"question\": \"If restricting network, list allowed CIDRs (comma-separated) that may connect to DB ports\",\n      \"type\": \"text\",\n      \"placeholder\": \"e.g., 10.0.0.0/8,192.168.0.0/16\",\n      \"validation\": {\n        \"required\": false\n      },\n      \"suggestedAnswer\": \"10.0.0.0/8\"\n    }\n  ],\n  \"open\": {\n    \"question\": \"Is there anything else about your requirements or constraints that would help us provide better recommendations?\",\n    \"placeholder\": \"e.g., specific security requirements, performance needs, connection pool sizing targets, or migration/restore constraints...\"\n  }\n}","performance":{"duration_ms":123952,"input_tokens":15729,"output_tokens":6547,"total_tokens":22276,"sdk":"vercel","model_version":"gpt-5","iterations":1,"tool_calls_executed":0,"cache_read_tokens":0,"cache_creation_tokens":0},"metadata":{"timestamp":"2025-10-11T21:28:27.426Z","complexity":"medium","tags":["troubleshooting"],"source":"integration_test","tool":"recommend","test_scenario":"recommend-question-generation","failure_analysis":""}}
