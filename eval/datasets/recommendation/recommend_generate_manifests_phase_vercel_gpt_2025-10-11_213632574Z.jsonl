{"input":{"issue":"Kubernetes manifest generation"},"output":"apiVersion: apiextensions.k8s.io/v1\nkind: CustomResourceDefinition\nmetadata:\n  name: clusters.postgresql.cnpg.io\n  labels:\n    dot-ai.io/managed: \"true\"\n    dot-ai.io/app-name: pg-prod\n    dot-ai.io/intent: deploy-postgresql-database\nspec:\n  group: postgresql.cnpg.io\n  scope: Namespaced\n  names:\n    plural: clusters\n    singular: cluster\n    kind: Cluster\n  versions:\n  - name: v1beta1\n    served: true\n    storage: true\n    schema:\n      openAPIV3Schema:\n        type: object\n        x-kubernetes-preserve-unknown-fields: true\n---\napiVersion: apiextensions.k8s.io/v1\nkind: CustomResourceDefinition\nmetadata:\n  name: backups.postgresql.cnpg.io\n  labels:\n    dot-ai.io/managed: \"true\"\n    dot-ai.io/app-name: pg-prod\n    dot-ai.io/intent: deploy-postgresql-database\nspec:\n  group: postgresql.cnpg.io\n  scope: Namespaced\n  names:\n    plural: backups\n    singular: backup\n    kind: Backup\n  versions:\n  - name: v1beta1\n    served: true\n    storage: true\n    schema:\n      openAPIV3Schema:\n        type: object\n        x-kubernetes-preserve-unknown-fields: true\n---\napiVersion: apiextensions.k8s.io/v1\nkind: CustomResourceDefinition\nmetadata:\n  name: scheduledbackups.postgresql.cnpg.io\n  labels:\n    dot-ai.io/managed: \"true\"\n    dot-ai.io/app-name: pg-prod\n    dot-ai.io/intent: deploy-postgresql-database\nspec:\n  group: postgresql.cnpg.io\n  scope: Namespaced\n  names:\n    plural: scheduledbackups\n    singular: scheduledbackup\n    kind: ScheduledBackup\n  versions:\n  - name: v1beta1\n    served: true\n    storage: true\n    schema:\n      openAPIV3Schema:\n        type: object\n        x-kubernetes-preserve-unknown-fields: true\n---\napiVersion: apiextensions.k8s.io/v1\nkind: CustomResourceDefinition\nmetadata:\n  name: poolers.postgresql.cnpg.io\n  labels:\n    dot-ai.io/managed: \"true\"\n    dot-ai.io/app-name: pg-prod\n    dot-ai.io/intent: deploy-postgresql-database\nspec:\n  group: postgresql.cnpg.io\n  scope: Namespaced\n  names:\n    plural: poolers\n    singular: pooler\n    kind: Pooler\n  versions:\n  - name: v1beta1\n    served: true\n    storage: true\n    schema:\n      openAPIV3Schema:\n        type: object\n        x-kubernetes-preserve-unknown-fields: true\n---\napiVersion: v1\nkind: Secret\nmetadata:\n  name: pg-backup-s3\n  namespace: default\n  labels:\n    dot-ai.io/managed: \"true\"\n    dot-ai.io/app-name: pg-prod\n    dot-ai.io/intent: deploy-postgresql-database\ntype: Opaque\nstringData:\n  AWS_ACCESS_KEY_ID: \"AKIAEXAMPLEID1234\"\n  AWS_SECRET_ACCESS_KEY: \"REDACTED-SECRET-KEY\"\n  AWS_REGION: \"us-east-1\"\n---\napiVersion: postgresql.cnpg.io/v1beta1\nkind: Cluster\nmetadata:\n  name: pg-prod\n  namespace: default\n  labels:\n    dot-ai.io/managed: \"true\"\n    dot-ai.io/app-name: pg-prod\n    dot-ai.io/intent: deploy-postgresql-database\nspec:\n  instances: 3\n  affinity:\n    enablePodAntiAffinity: true\n  enableSuperuserAccess: false\n  minSyncReplicas: 1\n  maxSyncReplicas: 1\n  primaryUpdateMethod: switchover\n  postgresql:\n    parameters:\n      shared_buffers: \"512MB\"\n      max_connections: \"200\"\n  resources:\n    requests:\n      cpu: \"1000m\"\n      memory: \"2Gi\"\n    limits:\n      cpu: \"2\"\n      memory: \"4Gi\"\n  storage:\n    size: \"100Gi\"\n    storageClass: \"standard\"\n  bootstrap:\n    initdb:\n      database: appdb\n      owner: appuser\n  backup:\n    barmanObjectStore:\n      destinationPath: \"s3://my-bucket/pg/pg-prod\"\n      s3Credentials:\n        accessKeyId:\n          name: pg-backup-s3\n          key: AWS_ACCESS_KEY_ID\n        secretAccessKey:\n          name: pg-backup-s3\n          key: AWS_SECRET_ACCESS_KEY\n        region:\n          name: pg-backup-s3\n          key: AWS_REGION\n      data:\n        encryption: AES256\n        compression: gzip\n      wal:\n        compression: gzip\n    retentionPolicy: \"30d\"\n---\napiVersion: postgresql.cnpg.io/v1beta1\nkind: Pooler\nmetadata:\n  name: pg-prod-pgbouncer\n  namespace: default\n  labels:\n    dot-ai.io/managed: \"true\"\n    dot-ai.io/app-name: pg-prod\n    dot-ai.io/intent: deploy-postgresql-database\nspec:\n  cluster:\n    name: pg-prod\n  instances: 2\n  type: rw\n  pgbouncer:\n    poolMode: transaction\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: pg-prod-pgbouncer-svc\n  namespace: default\n  labels:\n    dot-ai.io/managed: \"true\"\n    dot-ai.io/app-name: pg-prod\n    dot-ai.io/intent: deploy-postgresql-database\nspec:\n  type: ClusterIP\n  selector:\n    cnpg.io/cluster: pg-prod\n    cnpg.io/poolerName: pg-prod-pgbouncer\n  ports:\n    - name: postgres\n      port: 5432\n      targetPort: 5432\n---\napiVersion: postgresql.cnpg.io/v1beta1\nkind: ScheduledBackup\nmetadata:\n  name: pg-prod-daily-0200\n  namespace: default\n  labels:\n    dot-ai.io/managed: \"true\"\n    dot-ai.io/app-name: pg-prod\n    dot-ai.io/intent: deploy-postgresql-database\nspec:\n  cluster:\n    name: pg-prod\n  schedule: \"0 2 * * *\"\n  backupOwnerReference: cluster\n  target: prefer-standby\n---\napiVersion: postgresql.cnpg.io/v1beta1\nkind: Backup\nmetadata:\n  name: pg-prod-initial\n  namespace: default\n  labels:\n    dot-ai.io/managed: \"true\"\n    dot-ai.io/app-name: pg-prod\n    dot-ai.io/intent: deploy-postgresql-database\nspec:\n  cluster:\n    name: pg-prod\n  target: prefer-standby\n---\napiVersion: policy/v1\nkind: PodDisruptionBudget\nmetadata:\n  name: pg-prod-pdb\n  namespace: default\n  labels:\n    dot-ai.io/managed: \"true\"\n    dot-ai.io/app-name: pg-prod\n    dot-ai.io/intent: deploy-postgresql-database\nspec:\n  minAvailable: 2\n  selector:\n    matchLabels:\n      cnpg.io/cluster: pg-prod\n---\napiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: pg-prod-db-ingress-allowlist\n  namespace: default\n  labels:\n    dot-ai.io/managed: \"true\"\n    dot-ai.io/app-name: pg-prod\n    dot-ai.io/intent: deploy-postgresql-database\nspec:\n  podSelector:\n    matchLabels:\n      cnpg.io/cluster: pg-prod\n  policyTypes:\n    - Ingress\n  ingress:\n    - from:\n        - namespaceSelector:\n            matchLabels:\n              kubernetes.io/metadata.name: default\n      ports:\n        - protocol: TCP\n          port: 5432","performance":{"duration_ms":110765,"input_tokens":25330,"output_tokens":5769,"total_tokens":31099,"sdk":"vercel","model_version":"gpt-5","iterations":1,"tool_calls_executed":0,"cache_read_tokens":0,"cache_creation_tokens":0},"metadata":{"timestamp":"2025-10-11T21:36:32.574Z","complexity":"medium","tags":["troubleshooting"],"source":"integration_test","tool":"generate","test_scenario":"generate-manifests-generation","failure_analysis":""}}
